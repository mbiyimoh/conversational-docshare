@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* 33 Strategies Dark Theme */
    --color-bg: 240 20% 4%;           /* #0a0a0f */
    --color-bg-elevated: 240 18% 5%;   /* #0d0d14 */
    --color-bg-card: 0 0% 100% / 0.03; /* rgba(255,255,255,0.03) */
    --color-bg-modal: 230 15% 8% / 0.95; /* Near-opaque dark for modal readability */

    /* Text Hierarchy */
    --color-text: 0 0% 96%;            /* #f5f5f5 */
    --color-text-muted: 0 0% 53%;      /* #888888 */
    --color-text-dim: 0 0% 33%;        /* #555555 */

    /* Gold Accent */
    --color-accent: 41 57% 54%;        /* #d4a54a */
    --color-accent-glow: 41 57% 54% / 0.3;

    /* Borders */
    --color-border: 0 0% 100% / 0.08;

    /* Semantic Colors */
    --color-success: 142 69% 58%;      /* #4ade80 */
    --color-info: 217 91% 68%;         /* #60a5fa */
    --color-purple: 270 91% 65%;       /* #a78bfa */
    --color-warning: 38 92% 50%;       /* #f59e0b */
    --color-destructive: 0 84% 60%;    /* #f87171 */

    /* Typography */
    --font-display: "Instrument Serif", Georgia, serif;
    --font-body: "DM Sans", -apple-system, sans-serif;
    --font-mono: "JetBrains Mono", monospace;
    --font-size-base: 16px;

    /* Elite Typography Scale */
    --leading-chat: 1.65;             /* Optimal for dark mode reading */
    --leading-document: 1.7;          /* Slightly more for long-form */
    --spacing-paragraph: 1.25em;      /* Space between paragraphs */
    --spacing-list-item: 0.5em;       /* Space between list items */
    --spacing-heading: 1.5em;         /* Space above headings */
    --max-line-chat: 66ch;            /* Optimal line length for chat */
    --max-line-document: 72ch;        /* Slightly wider for documents */
    --letter-spacing-body: 0.01em;    /* Slight character separation */
    --font-weight-dark: 450;          /* Slightly heavier for dark mode */

    /* Spacing */
    --radius: 0.75rem;

    /* Paper Mode Variables - Document-specific light theme */
    --color-paper-bg: 40 23% 95%;           /* #F5F3EF warm cream */
    --color-paper-text: 0 0% 13%;           /* #222222 near-black */
    --color-paper-text-muted: 0 0% 40%;     /* #666666 muted */
    --color-paper-border: 0 0% 85%;         /* #D9D9D9 subtle border */
    --color-paper-shadow: 0 0% 0% / 0.08;   /* Soft shadow */
    --color-paper-accent: 41 70% 45%;       /* Darker gold for contrast */
    --color-paper-accent-bg: 41 70% 45% / 0.15;

    /* Legacy shadcn compatibility */
    --background: var(--color-bg);
    --foreground: var(--color-text);
    --card: var(--color-bg-card);
    --card-foreground: var(--color-text);
    --primary: var(--color-accent);
    --primary-foreground: var(--color-bg);
    --secondary: var(--color-bg-elevated);
    --secondary-foreground: var(--color-text);
    --muted: var(--color-bg-elevated);
    --muted-foreground: var(--color-text-muted);
    --accent: var(--color-accent);
    --accent-foreground: var(--color-bg);
    --destructive: var(--color-destructive);
    --destructive-foreground: var(--color-text);
    --border: var(--color-border);
    --input: var(--color-border);
    --ring: var(--color-accent);
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground font-body;
  }
}

/* Backdrop filter fallback */
@supports not (backdrop-filter: blur(4px)) {
  .backdrop-blur-sm {
    background: rgba(20, 20, 30, 0.95) !important;
  }
}

/* Citation Highlight Animation - Updated for dark theme */
@keyframes citation-glow {
  0% {
    background-color: hsl(var(--color-accent) / 0.3);
    box-shadow: 0 0 0 4px hsl(var(--color-accent) / 0.2);
  }
  70% {
    background-color: hsl(var(--color-accent) / 0.3);
    box-shadow: 0 0 0 4px hsl(var(--color-accent) / 0.2);
  }
  100% {
    background-color: transparent;
    box-shadow: none;
  }
}

.citation-highlight {
  animation: citation-glow 2.5s ease-out forwards;
  border-radius: 0.25rem;
  transition: background-color 0.3s ease-out, box-shadow 0.3s ease-out;
}

@media (prefers-reduced-motion: reduce) {
  .citation-highlight {
    animation: none;
    background-color: hsl(var(--color-accent) / 0.2);
    border-left: 4px solid hsl(var(--color-accent));
    box-shadow: none;
  }
}

/* Citation highlight for paper mode */
.paper-mode .citation-highlight {
  animation: citation-glow-paper 2.5s ease-out forwards;
}

@keyframes citation-glow-paper {
  0% {
    background-color: hsl(41 70% 45% / 0.3);
    box-shadow: 0 0 0 4px hsl(41 70% 45% / 0.2);
  }
  70% {
    background-color: hsl(41 70% 45% / 0.3);
    box-shadow: 0 0 0 4px hsl(41 70% 45% / 0.2);
  }
  100% {
    background-color: transparent;
    box-shadow: none;
  }
}

/* Theme variants - applied via data-theme attribute or CSS variables */
[data-theme="nord"] {
  --color-bg: 220 16% 22%;
  --color-bg-elevated: 222 16% 28%;
  --color-bg-card: 220 16% 26% / 0.5;
  --color-text: 218 27% 94%;
  --color-text-muted: 219 28% 72%;
  --color-text-dim: 219 20% 55%;
  --color-accent: 193 43% 67%;
  --color-accent-glow: 193 43% 67% / 0.3;
  --color-border: 220 16% 36% / 0.5;
}

[data-theme="warm-reading"] {
  --color-bg: 30 20% 13%;
  --color-bg-elevated: 30 18% 18%;
  --color-bg-card: 30 15% 20% / 0.5;
  --color-text: 35 30% 85%;
  --color-text-muted: 35 20% 60%;
  --color-text-dim: 35 15% 45%;
  --color-accent: 41 57% 54%;
  --color-accent-glow: 41 57% 54% / 0.3;
  --color-border: 30 15% 25% / 0.5;
}

[data-theme="high-contrast"] {
  --color-bg: 0 0% 0%;
  --color-bg-elevated: 0 0% 8%;
  --color-bg-card: 0 0% 5% / 0.8;
  --color-text: 0 0% 100%;
  --color-text-muted: 0 0% 70%;
  --color-text-dim: 0 0% 50%;
  --color-accent: 48 96% 53%;
  --color-accent-glow: 48 96% 53% / 0.4;
  --color-border: 0 0% 100% / 0.2;
}

[data-theme="soft-charcoal"] {
  --color-bg: 0 0% 10%;
  --color-bg-elevated: 0 0% 14%;
  --color-bg-card: 0 0% 12% / 0.5;
  --color-text: 0 0% 88%;
  --color-text-muted: 0 0% 55%;
  --color-text-dim: 0 0% 40%;
  --color-accent: 258 90% 66%;
  --color-accent-glow: 258 90% 66% / 0.3;
  --color-border: 0 0% 100% / 0.1;
}

[data-theme="ocean-depth"] {
  --color-bg: 210 50% 8%;
  --color-bg-elevated: 210 45% 12%;
  --color-bg-card: 210 40% 15% / 0.5;
  --color-text: 185 40% 92%;
  --color-text-muted: 200 25% 55%;
  --color-text-dim: 200 20% 40%;
  --color-accent: 175 60% 50%;
  --color-accent-glow: 175 60% 50% / 0.3;
  --color-border: 200 40% 30% / 0.4;
}

/* Jump indicator breathing animation */
@keyframes breathe-glow {
  0%, 100% {
    box-shadow: 0 0 0 0 hsl(var(--color-accent) / 0);
  }
  50% {
    box-shadow: 0 0 20px 4px hsl(var(--color-accent) / 0.3);
  }
}

.animate-breathe-glow {
  animation: breathe-glow 2s ease-in-out infinite;
}

@media (prefers-reduced-motion: reduce) {
  .animate-breathe-glow {
    animation: none;
  }
}

/* ===========================================
   Theme-Aware Scrollbar Styling
   =========================================== */

/* WebKit browsers (Chrome, Safari, Edge) */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: hsl(var(--color-bg-elevated));
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: hsl(var(--color-text-dim));
  border-radius: 4px;
  border: 2px solid transparent;
  background-clip: padding-box;
}

::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--color-text-muted));
  border: 2px solid transparent;
  background-clip: padding-box;
}

::-webkit-scrollbar-thumb:active {
  background: hsl(var(--color-accent));
}

/* Corner where horizontal and vertical scrollbars meet */
::-webkit-scrollbar-corner {
  background: hsl(var(--color-bg-elevated));
}

/* Firefox */
* {
  scrollbar-width: thin;
  scrollbar-color: hsl(var(--color-text-dim)) hsl(var(--color-bg-elevated));
}

/* Thin scrollbar variant for nested containers */
.scrollbar-thin::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

/* Hide scrollbar but keep functionality */
.scrollbar-hidden {
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.scrollbar-hidden::-webkit-scrollbar {
  display: none;
}
