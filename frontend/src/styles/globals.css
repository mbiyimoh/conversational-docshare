@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* 33 Strategies Dark Theme */
    --color-bg: 240 20% 4%;           /* #0a0a0f */
    --color-bg-elevated: 240 18% 5%;   /* #0d0d14 */
    --color-bg-card: 0 0% 100% / 0.03; /* rgba(255,255,255,0.03) */
    --color-bg-modal: 230 15% 8% / 0.95; /* Near-opaque dark for modal readability */

    /* Text Hierarchy */
    --color-text: 0 0% 96%;            /* #f5f5f5 */
    --color-text-muted: 0 0% 53%;      /* #888888 */
    --color-text-dim: 0 0% 33%;        /* #555555 */

    /* Gold Accent */
    --color-accent: 41 57% 54%;        /* #d4a54a */
    --color-accent-glow: 41 57% 54% / 0.3;

    /* Borders */
    --color-border: 0 0% 100% / 0.08;

    /* Semantic Colors */
    --color-success: 142 69% 58%;      /* #4ade80 */
    --color-info: 217 91% 68%;         /* #60a5fa */
    --color-purple: 270 91% 65%;       /* #a78bfa */
    --color-warning: 38 92% 50%;       /* #f59e0b */
    --color-destructive: 0 84% 60%;    /* #f87171 */

    /* Typography */
    --font-display: "Instrument Serif", Georgia, serif;
    --font-body: "DM Sans", -apple-system, sans-serif;
    --font-mono: "JetBrains Mono", monospace;

    /* Spacing */
    --radius: 0.75rem;

    /* Legacy shadcn compatibility */
    --background: var(--color-bg);
    --foreground: var(--color-text);
    --card: var(--color-bg-card);
    --card-foreground: var(--color-text);
    --primary: var(--color-accent);
    --primary-foreground: var(--color-bg);
    --secondary: var(--color-bg-elevated);
    --secondary-foreground: var(--color-text);
    --muted: var(--color-bg-elevated);
    --muted-foreground: var(--color-text-muted);
    --accent: var(--color-accent);
    --accent-foreground: var(--color-bg);
    --destructive: var(--color-destructive);
    --destructive-foreground: var(--color-text);
    --border: var(--color-border);
    --input: var(--color-border);
    --ring: var(--color-accent);
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground font-body;
  }
}

/* Backdrop filter fallback */
@supports not (backdrop-filter: blur(4px)) {
  .backdrop-blur-sm {
    background: rgba(20, 20, 30, 0.95) !important;
  }
}

/* Citation Highlight Animation - Updated for dark theme */
@keyframes citation-glow {
  0% {
    background-color: hsl(var(--color-accent) / 0.3);
    box-shadow: 0 0 0 4px hsl(var(--color-accent) / 0.2);
  }
  70% {
    background-color: hsl(var(--color-accent) / 0.3);
    box-shadow: 0 0 0 4px hsl(var(--color-accent) / 0.2);
  }
  100% {
    background-color: transparent;
    box-shadow: none;
  }
}

.citation-highlight {
  animation: citation-glow 2.5s ease-out forwards;
  border-radius: 0.25rem;
  transition: background-color 0.3s ease-out, box-shadow 0.3s ease-out;
}

@media (prefers-reduced-motion: reduce) {
  .citation-highlight {
    animation: none;
    background-color: hsl(var(--color-accent) / 0.2);
    border-left: 4px solid hsl(var(--color-accent));
    box-shadow: none;
  }
}

/* Theme variants - applied via data-theme attribute or CSS variables */
[data-theme="nord"] {
  --color-bg: 220 16% 22%;
  --color-bg-elevated: 222 16% 28%;
  --color-bg-card: 220 16% 26% / 0.5;
  --color-text: 218 27% 94%;
  --color-text-muted: 219 28% 72%;
  --color-text-dim: 219 20% 55%;
  --color-accent: 193 43% 67%;
  --color-accent-glow: 193 43% 67% / 0.3;
  --color-border: 220 16% 36% / 0.5;
}

[data-theme="warm-reading"] {
  --color-bg: 30 20% 13%;
  --color-bg-elevated: 30 18% 18%;
  --color-bg-card: 30 15% 20% / 0.5;
  --color-text: 35 30% 85%;
  --color-text-muted: 35 20% 60%;
  --color-text-dim: 35 15% 45%;
  --color-accent: 41 57% 54%;
  --color-accent-glow: 41 57% 54% / 0.3;
  --color-border: 30 15% 25% / 0.5;
}

[data-theme="high-contrast"] {
  --color-bg: 0 0% 0%;
  --color-bg-elevated: 0 0% 8%;
  --color-bg-card: 0 0% 5% / 0.8;
  --color-text: 0 0% 100%;
  --color-text-muted: 0 0% 70%;
  --color-text-dim: 0 0% 50%;
  --color-accent: 48 96% 53%;
  --color-accent-glow: 48 96% 53% / 0.4;
  --color-border: 0 0% 100% / 0.2;
}

[data-theme="soft-charcoal"] {
  --color-bg: 0 0% 10%;
  --color-bg-elevated: 0 0% 14%;
  --color-bg-card: 0 0% 12% / 0.5;
  --color-text: 0 0% 88%;
  --color-text-muted: 0 0% 55%;
  --color-text-dim: 0 0% 40%;
  --color-accent: 258 90% 66%;
  --color-accent-glow: 258 90% 66% / 0.3;
  --color-border: 0 0% 100% / 0.1;
}

/* Jump indicator breathing animation */
@keyframes breathe-glow {
  0%, 100% {
    box-shadow: 0 0 0 0 hsl(var(--color-accent) / 0);
  }
  50% {
    box-shadow: 0 0 20px 4px hsl(var(--color-accent) / 0.3);
  }
}

.animate-breathe-glow {
  animation: breathe-glow 2s ease-in-out infinite;
}

@media (prefers-reduced-motion: reduce) {
  .animate-breathe-glow {
    animation: none;
  }
}
